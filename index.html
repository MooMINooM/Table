<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡∏ü‡∏∏‡∏ï‡∏ö‡∏≠‡∏• ‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå ‡πÄ‡∏Å‡∏°‡∏™‡πå 2568 (V.15 ‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏£‡∏∏‡πà‡∏ô)</title>
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
<style>
    :root { --primary: #1a5f7a; --secondary: #ffc107; --success: #2ecc71; --danger: #e74c3c; --dark: #2c3e50; --light: #f8f9fa; }
    body { font-family: 'Sarabun', sans-serif; background: #eef2f5; margin: 0; padding: 20px; color: var(--dark); padding-bottom: 80px; }
    .container { max-width: 1200px; margin: 0 auto; background: white; padding: 20px; border-radius: 15px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
    
    .header { text-align: center; margin-bottom: 20px; border-bottom: 2px solid #eee; padding-bottom: 15px; }
    .tabs { display: flex; gap: 10px; margin-bottom: 20px; overflow-x: auto; padding-bottom: 5px; }
    .tab-btn { padding: 10px 20px; border: none; background: #e0e0e0; border-radius: 20px; cursor: pointer; font-weight: bold; color: #555; transition: 0.3s; white-space: nowrap; }
    .tab-btn.active { background: var(--primary); color: white; box-shadow: 0 4px 6px rgba(26, 95, 122, 0.3); }
    
    .table-responsive { overflow-x: auto; }
    table { width: 100%; border-collapse: collapse; margin-bottom: 15px; min-width: 800px; font-size: 14px; }
    th { background: var(--dark); color: white; padding: 10px; text-align: left; }
    td { padding: 8px 10px; border-bottom: 1px solid #eee; vertical-align: middle; }
    tr:nth-child(even) { background: #f9f9f9; }
    
    input[type="number"] { width: 50px; padding: 5px; text-align: center; border: 2px solid #ddd; border-radius: 5px; font-weight: bold; font-size: 1.2em; color: #333; }
    input[type="number"]:focus { border-color: var(--primary); outline: none; background: #e3f2fd; }
    
    .ref-badge { background: #e3f2fd; color: #1565c0; padding: 4px 8px; border-radius: 4px; font-size: 0.85em; display: inline-block; font-weight: 600; border: 1px solid #bbdefb; cursor: pointer; min-width: 120px; text-align: center; }
    
    #toast { visibility: hidden; min-width: 250px; background-color: #333; color: #fff; text-align: center; border-radius: 2px; padding: 16px; position: fixed; z-index: 9999; left: 50%; bottom: 30px; transform: translateX(-50%); font-size: 17px; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
    #toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }

    .control-panel { position: fixed; bottom: 20px; right: 20px; display: flex; gap: 10px; z-index: 1000; }
    .action-btn { width: 50px; height: 50px; border-radius: 50%; border: none; color: white; font-size: 1.2em; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.2); display: flex; align-items: center; justify-content: center; transition: transform 0.2s; }
    .action-btn:hover { transform: scale(1.1); }
    .btn-save { background: var(--success); }
    .btn-reset { background: var(--danger); }

    /* ‡∏õ‡πâ‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡∏∞‡∏£‡∏∏‡πà‡∏ô‡∏≠‡∏≤‡∏¢‡∏∏ */
    .cat-badge { font-size: 0.85em; padding: 3px 8px; border-radius: 4px; color: white; display: inline-block; font-weight: 600; margin-right: 5px; margin-bottom: 2px; box-shadow: 0 1px 2px rgba(0,0,0,0.1); }
    
    /* ‡∏™‡∏µ‡πÅ‡∏ö‡πà‡∏á‡∏ï‡∏≤‡∏°‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô */
    .level-anu { background-color: #e84393; } /* ‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏• - ‡∏ä‡∏°‡∏û‡∏π‡πÄ‡∏Ç‡πâ‡∏° */
    .level-p13 { background-color: #00b894; } /* ‡∏õ.‡∏ï‡πâ‡∏ô - ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß */
    .level-p46 { background-color: #0984e3; } /* ‡∏õ.‡∏õ‡∏•‡∏≤‡∏¢ - ‡∏ü‡πâ‡∏≤ */
    .level-sec { background-color: #e67e22; } /* ‡∏°‡∏±‡∏ò‡∏¢‡∏° - ‡∏™‡πâ‡∏° */

    /* ‡∏™‡∏µ‡πÄ‡∏û‡∏® */
    .gender-m { color: #2980b9; font-weight: bold; background: #ebf5fb; padding: 2px 5px; border-radius: 3px; font-size: 0.8em; }
    .gender-f { color: #c0392b; font-weight: bold; background: #fdedec; padding: 2px 5px; border-radius: 3px; font-size: 0.8em; }

    .standing-box { background: #fff; border: 1px solid #ddd; border-radius: 8px; overflow: hidden; margin-bottom: 20px; }
    .standing-header { background: var(--primary); color: white; padding: 10px; font-weight: bold; display: flex; justify-content: space-between; }
    .st-table th { background: #f1f1f1; color: #333; font-size: 0.85em; text-align: center; }
    .st-table td { text-align: center; font-size: 0.9em; }
    .pts-cell { font-weight: bold; color: var(--primary); background: #e3f2fd; }
    .gender-section-title { text-align: center; color: #1a5f7a; margin-top: 30px; border-bottom: 3px solid #ffc107; display: inline-block; padding-bottom: 5px; }

    @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
    @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }
</style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>‚öΩ ‡∏ü‡∏∏‡∏ï‡∏ö‡∏≠‡∏• ‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå ‡πÄ‡∏Å‡∏°‡∏™‡πå 2568</h1>
        <p>‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏• ‚Ä¢ ‡∏õ.‡∏ï‡πâ‡∏ô ‚Ä¢ ‡∏õ.‡∏õ‡∏•‡∏≤‡∏¢ ‚Ä¢ ‡∏°‡∏±‡∏ò‡∏¢‡∏°</p>
    </div>

    <div class="tabs">
        <button class="tab-btn active" onclick="switchTab('day1')">üìÖ 16 ‡∏ò.‡∏Ñ.</button>
        <button class="tab-btn" onclick="switchTab('day2')">üìÖ 17 ‡∏ò.‡∏Ñ.</button>
        <button class="tab-btn" onclick="switchTab('day3')">üìÖ 18 ‡∏ò.‡∏Ñ.</button>
        <button class="tab-btn" onclick="switchTab('day4')">üìÖ 19 ‡∏ò.‡∏Ñ.</button>
        <button class="tab-btn" style="background:#2c3e50; color:white;" onclick="switchTab('standings')">üìä ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</button>
    </div>

    <div id="content-area"></div>
</div>

<div id="toast">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß ‚úÖ</div>

<div class="control-panel">
    <button class="action-btn btn-save" onclick="saveDataManual()" title="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"><i class="fas fa-save"></i></button>
    <button class="action-btn btn-reset" onclick="resetData()" title="‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÉ‡∏´‡∏°‡πà"><i class="fas fa-trash"></i></button>
</div>

<script>
    // --- ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏•‡∏∏‡πà‡∏° ---
    const groups = {
        "A": ["‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏≤‡∏ó‡∏Ø", "‡∏ó‡πà‡∏≤‡∏≠‡∏∏‡∏ó‡∏±‡∏¢", "‡∏î‡πâ‡∏ß‡∏á‡∏Ø-‡∏ä‡∏≥‡∏Ø"], 
        "B": ["‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå‡∏Ø", "‡πÇ‡∏ô‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á", "‡πÇ‡∏ô‡∏ô‡πÑ‡∏´‡∏°‡∏Ø"],
        "C": ["‡∏†‡∏π‡∏û‡∏£‡∏∞‡∏Ø", "‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø", "‡πÇ‡∏ô‡∏ô‡∏°‡πà‡∏ß‡∏á"],
        "M": ["‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø", "‡∏†‡∏π‡∏û‡∏£‡∏∞‡∏Ø", "‡πÇ‡∏ô‡∏ô‡∏°‡πà‡∏ß‡∏á", "‡πÇ‡∏ô‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á"]
    };

    /* level code: 
       ANU = ‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•, P13 = ‡∏õ.1-3, P46 = ‡∏õ.4-6, SEC = ‡∏°‡∏±‡∏ò‡∏¢‡∏°
       gender: M = ‡∏ä‡∏≤‡∏¢, F = ‡∏´‡∏ç‡∏¥‡∏á
    */
    let matches = [
        // === ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 16 ‡∏ò.‡∏Ñ. ===
        // 08.30: ‡πÄ‡∏õ‡∏¥‡∏î‡∏´‡∏±‡∏ß‡∏î‡πâ‡∏ß‡∏¢ ‡∏õ.‡∏õ‡∏•‡∏≤‡∏¢ ‡πÅ‡∏•‡∏∞ ‡∏°‡∏±‡∏ò‡∏¢‡∏°
        { id: "M1", day: "day1", time: "08.30", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P46", gender: "M", groupKey: "A", t1: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏≤‡∏ó‡∏Ø", t2: "‡∏ó‡πà‡∏≤‡∏≠‡∏∏‡∏ó‡∏±‡∏¢", s1: "", s2: "", ref: "‡∏î‡πâ‡∏ß‡∏á‡∏Ø-‡∏ä‡∏≥‡∏Ø" },
        { id: "M2", day: "day1", time: "08.30", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "SEC", gender: "M", groupKey: "M", t1: "‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø", t2: "‡∏†‡∏π‡∏û‡∏£‡∏∞‡∏Ø", s1: "", s2: "", ref: "‡πÇ‡∏ô‡∏ô‡∏°‡πà‡∏ß‡∏á" },
        { id: "A1", day: "day1", time: "08.30", field: "‡∏™‡∏ô‡∏≤‡∏°‡πÄ‡∏î‡πá‡∏Å", level: "ANU", gender: "M", groupKey: "A", t1: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏≤‡∏ó‡∏Ø", t2: "‡∏ó‡πà‡∏≤‡∏≠‡∏∏‡∏ó‡∏±‡∏¢", s1: "", s2: "", ref: "‡∏î‡πâ‡∏ß‡∏á‡∏Ø-‡∏ä‡∏≥‡∏Ø" },

        // 09.30: ‡∏õ.‡∏ï‡πâ‡∏ô ‡πÅ‡∏•‡∏∞ ‡∏õ.‡∏õ‡∏•‡∏≤‡∏¢ ‡∏™‡∏≤‡∏¢ B
        { id: "M3", day: "day1", time: "09.30", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P46", gender: "M", groupKey: "B", t1: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå‡∏Ø", t2: "‡πÇ‡∏ô‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á", s1: "", s2: "", ref: "‡πÇ‡∏ô‡∏ô‡πÑ‡∏´‡∏°‡∏Ø" },
        { id: "M4", day: "day1", time: "09.30", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "P13", gender: "M", groupKey: "A", t1: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏≤‡∏ó‡∏Ø", t2: "‡∏ó‡πà‡∏≤‡∏≠‡∏∏‡∏ó‡∏±‡∏¢", s1: "", s2: "", ref: "‡∏î‡πâ‡∏ß‡∏á‡∏Ø-‡∏ä‡∏≥‡∏Ø" },
        { id: "A2", day: "day1", time: "09.30", field: "‡∏™‡∏ô‡∏≤‡∏°‡πÄ‡∏î‡πá‡∏Å", level: "ANU", gender: "M", groupKey: "B", t1: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå‡∏Ø", t2: "‡πÇ‡∏ô‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á", s1: "", s2: "", ref: "‡πÇ‡∏ô‡∏ô‡πÑ‡∏´‡∏°‡∏Ø" },

        // 10.30: ‡∏õ.‡∏õ‡∏•‡∏≤‡∏¢ ‡∏™‡∏≤‡∏¢ C ‡πÅ‡∏•‡∏∞ ‡∏°‡∏±‡∏ò‡∏¢‡∏°
        { id: "M5", day: "day1", time: "10.30", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P46", gender: "M", groupKey: "C", t1: "‡∏†‡∏π‡∏û‡∏£‡∏∞‡∏Ø", t2: "‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø", s1: "", s2: "", ref: "‡πÇ‡∏ô‡∏ô‡∏°‡πà‡∏ß‡∏á" },
        { id: "M6", day: "day1", time: "10.30", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "SEC", gender: "M", groupKey: "M", t1: "‡πÇ‡∏ô‡∏ô‡∏°‡πà‡∏ß‡∏á", t2: "‡πÇ‡∏ô‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á", s1: "", s2: "", ref: "‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø" },

        // 13.00: ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ó‡∏µ‡∏°‡∏´‡∏ç‡∏¥‡∏á
        { id: "W1", day: "day1", time: "13.00", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P46", gender: "F", groupKey: "A", t1: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏≤‡∏ó‡∏Ø", t2: "‡∏ó‡πà‡∏≤‡∏≠‡∏∏‡∏ó‡∏±‡∏¢", s1: "", s2: "", ref: "‡∏î‡πâ‡∏ß‡∏á‡∏Ø-‡∏ä‡∏≥‡∏Ø" },
        { id: "W2", day: "day1", time: "13.00", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "SEC", gender: "F", groupKey: "M", t1: "‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø", t2: "‡∏†‡∏π‡∏û‡∏£‡∏∞‡∏Ø", s1: "", s2: "", ref: "‡πÇ‡∏ô‡∏ô‡∏°‡πà‡∏ß‡∏á" },
        { id: "AW1", day: "day1", time: "13.00", field: "‡∏™‡∏ô‡∏≤‡∏°‡πÄ‡∏î‡πá‡∏Å", level: "ANU", gender: "F", groupKey: "A", t1: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏≤‡∏ó‡∏Ø", t2: "‡∏ó‡πà‡∏≤‡∏≠‡∏∏‡∏ó‡∏±‡∏¢", s1: "", s2: "", ref: "‡∏î‡πâ‡∏ß‡∏á‡∏Ø-‡∏ä‡∏≥‡∏Ø" },

        // 14.00: ‡∏´‡∏ç‡∏¥‡∏á ‡∏™‡∏≤‡∏¢ B ‡πÅ‡∏•‡∏∞ ‡∏õ.‡∏ï‡πâ‡∏ô
        { id: "W3", day: "day1", time: "14.00", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P46", gender: "F", groupKey: "B", t1: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå‡∏Ø", t2: "‡πÇ‡∏ô‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á", s1: "", s2: "", ref: "‡πÇ‡∏ô‡∏ô‡πÑ‡∏´‡∏°‡∏Ø" },
        { id: "W4", day: "day1", time: "14.00", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "P13", gender: "F", groupKey: "A", t1: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏≤‡∏ó‡∏Ø", t2: "‡∏ó‡πà‡∏≤‡∏≠‡∏∏‡∏ó‡∏±‡∏¢", s1: "", s2: "", ref: "‡∏î‡πâ‡∏ß‡∏á‡∏Ø-‡∏ä‡∏≥‡∏Ø" },

        // === ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 17 ‡∏ò.‡∏Ñ. (‡∏ô‡∏±‡∏î‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏£‡∏≠‡∏ö‡πÅ‡∏£‡∏Å & ‡∏£‡∏≠‡∏ö 8 ‡∏ó‡∏µ‡∏°) ===
        { id: "M7", day: "day2", time: "13.00", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P46", gender: "M", groupKey: "A", t1: "‡∏ó‡πà‡∏≤‡∏≠‡∏∏‡∏ó‡∏±‡∏¢", t2: "‡∏î‡πâ‡∏ß‡∏á‡∏Ø-‡∏ä‡∏≥‡∏Ø", s1: "", s2: "", ref: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏≤‡∏ó‡∏Ø" },
        { id: "M8", day: "day2", time: "13.00", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "P13", gender: "M", groupKey: "A", t1: "‡∏ó‡πà‡∏≤‡∏≠‡∏∏‡∏ó‡∏±‡∏¢", t2: "‡∏î‡πâ‡∏ß‡∏á‡∏Ø-‡∏ä‡∏≥‡∏Ø", s1: "", s2: "", ref: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏≤‡∏ó‡∏Ø" },
        
        { id: "QF1", day: "day2", time: "15.00", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P46", gender: "M", cat: "‡∏£‡∏≠‡∏ö 8 ‡∏ó‡∏µ‡∏°", t1: "(‡∏ó‡∏µ‡πà 1 A)", t2: "(‡∏ó‡∏µ‡πà 3 ‡∏î‡∏µ‡∏™‡∏∏‡∏î)", s1: "", s2: "", ref: "‡∏ó‡∏µ‡∏°‡∏ï‡∏Å‡∏£‡∏≠‡∏ö", next: "SF1", slot: 1 },
        { id: "QF2", day: "day2", time: "15.00", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "P46", gender: "M", cat: "‡∏£‡∏≠‡∏ö 8 ‡∏ó‡∏µ‡∏°", t1: "(‡∏ó‡∏µ‡πà 1 B)", t2: "(‡∏ó‡∏µ‡πà 3 ‡∏£‡∏≠‡∏á)", s1: "", s2: "", ref: "‡∏ó‡∏µ‡∏°‡∏ï‡∏Å‡∏£‡∏≠‡∏ö", next: "SF1", slot: 2 },

        // === ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 18 ‡∏ò.‡∏Ñ. (‡∏£‡∏≠‡∏ö‡∏£‡∏≠‡∏á) ===
        { id: "SF1", day: "day3", time: "09.00", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P46", gender: "M", cat: "‡∏£‡∏≠‡∏ö‡∏£‡∏≠‡∏á‡∏Ø", t1: "(‡∏£‡∏≠ QF1)", t2: "(‡∏£‡∏≠ QF2)", s1: "", s2: "", ref: "‡∏ó‡∏µ‡∏°‡πÅ‡∏û‡πâ QF", next: "FINAL", slot: 1 },
        { id: "SF2", day: "day3", time: "10.00", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P46", gender: "M", cat: "‡∏£‡∏≠‡∏ö‡∏£‡∏≠‡∏á‡∏Ø", t1: "(‡∏£‡∏≠‡∏ú‡∏•)", t2: "(‡∏£‡∏≠‡∏ú‡∏•)", s1: "", s2: "", ref: "‡∏ó‡∏µ‡∏°‡πÅ‡∏û‡πâ QF", next: "FINAL", slot: 2 },
        { id: "SFA1", day: "day3", time: "09.00", field: "‡∏™‡∏ô‡∏≤‡∏°‡πÄ‡∏î‡πá‡∏Å", level: "ANU", gender: "M", cat: "‡∏£‡∏≠‡∏ö‡∏£‡∏≠‡∏á‡∏Ø", t1: "(‡∏ó‡∏µ‡πà 1 A)", t2: "(‡∏ó‡∏µ‡πà 2 B)", s1: "", s2: "", ref: "‡∏ó‡∏µ‡∏°‡πÅ‡∏û‡πâ QF" },

        // === ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 19 ‡∏ò.‡∏Ñ. (‡∏ä‡∏¥‡∏á‡∏ä‡∏ô‡∏∞‡πÄ‡∏•‡∏¥‡∏®) ===
        { id: "FIN_A", day: "day4", time: "08.30", field: "‡∏™‡∏ô‡∏≤‡∏°‡πÄ‡∏î‡πá‡∏Å", level: "ANU", gender: "M", cat: "‡∏ä‡∏¥‡∏á‡∏ä‡∏ô‡∏∞‡πÄ‡∏•‡∏¥‡∏®", t1: "(‡∏£‡∏≠‡∏ä‡∏¥‡∏á)", t2: "(‡∏£‡∏≠‡∏ä‡∏¥‡∏á)", s1: "", s2: "", ref: "‡∏ä‡∏∏‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©" },
        { id: "FIN_P13", day: "day4", time: "08.30", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "P13", gender: "M", cat: "‡∏ä‡∏¥‡∏á‡∏ä‡∏ô‡∏∞‡πÄ‡∏•‡∏¥‡∏®", t1: "(‡∏£‡∏≠‡∏ä‡∏¥‡∏á)", t2: "(‡∏£‡∏≠‡∏ä‡∏¥‡∏á)", s1: "", s2: "", ref: "‡∏ä‡∏∏‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©" },
        { id: "FIN_P46", day: "day4", time: "09.30", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P46", gender: "M", cat: "‡∏ä‡∏¥‡∏á‡∏ä‡∏ô‡∏∞‡πÄ‡∏•‡∏¥‡∏®", t1: "(‡∏£‡∏≠‡∏ä‡∏¥‡∏á)", t2: "(‡∏£‡∏≠‡∏ä‡∏¥‡∏á)", s1: "", s2: "", ref: "‡∏ä‡∏∏‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©" },
        { id: "FIN_SEC", day: "day4", time: "09.30", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "SEC", gender: "M", cat: "‡∏ä‡∏¥‡∏á‡∏ä‡∏ô‡∏∞‡πÄ‡∏•‡∏¥‡∏®", t1: "(‡∏£‡∏≠‡∏ä‡∏¥‡∏á)", t2: "(‡∏£‡∏≠‡∏ä‡∏¥‡∏á)", s1: "", s2: "", ref: "‡∏ä‡∏∏‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©" }
    ];

    let currentTab = 'day1';

    document.addEventListener('DOMContentLoaded', () => {
        loadData();
        renderPage();
    });

    function switchTab(tab) {
        currentTab = tab;
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');
        renderPage();
    }

    function renderPage() {
        const container = document.getElementById('content-area');
        if (currentTab === 'standings') renderStandings(container);
        else renderSchedule(container, currentTab);
    }

    // Helper: ‡πÅ‡∏õ‡∏•‡∏á‡∏£‡∏´‡∏±‡∏™‡∏£‡∏∞‡∏î‡∏±‡∏ö‡∏ä‡∏±‡πâ‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡∏ä‡∏∑‡πà‡∏≠‡πÑ‡∏ó‡∏¢ + ‡∏™‡∏µ
    function getLevelInfo(code) {
        switch(code) {
            case 'ANU': return { name: '‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•', class: 'level-anu' };
            case 'P13': return { name: '‡∏õ.1-3', class: 'level-p13' };
            case 'P46': return { name: '‡∏õ.4-6', class: 'level-p46' };
            case 'SEC': return { name: '‡∏°‡∏±‡∏ò‡∏¢‡∏°', class: 'level-sec' };
            default: return { name: '‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ', class: 'level-p46' };
        }
    }

    function renderSchedule(container, day) {
        // ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡πÄ‡∏ß‡∏•‡∏≤
        const dayMatches = matches.filter(m => m.day === day).sort((a, b) => a.time.localeCompare(b.time));
        
        let html = `<div class="table-responsive"><table><thead><tr>
            <th width="10%">‡πÄ‡∏ß‡∏•‡∏≤</th><th width="20%">‡∏™‡∏ô‡∏≤‡∏°/‡∏£‡∏∏‡πà‡∏ô</th>
            <th width="35%">‡∏Ñ‡∏π‡πà‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô (‡∏ú‡∏•‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô)</th>
            <th width="25%">‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£</th>
            <th width="10%">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</th>
        </tr></thead><tbody>`;

        if (dayMatches.length === 0) {
            html += `<tr><td colspan="5" style="text-align:center; padding:20px;">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</td></tr>`;
        } else {
            dayMatches.forEach(m => {
                let s1 = parseInt(m.s1 || -1), s2 = parseInt(m.s2 || -1);
                let win1 = (s1 > s2) ? "color:#2ecc71; font-weight:bold; text-decoration:underline;" : "";
                let win2 = (s2 > s1) ? "color:#2ecc71; font-weight:bold; text-decoration:underline;" : "";
                let conflictStyle = (m.t1.includes(m.ref) || m.t2.includes(m.ref)) ? "border:2px solid red; background:#ffebee; color:red;" : "";
                
                let lvl = getLevelInfo(m.level);
                let genderBadge = m.gender === 'M' ? '<span class="gender-m">‡∏ä‡∏≤‡∏¢</span>' : '<span class="gender-f">‡∏´‡∏ç‡∏¥‡∏á</span>';

                html += `<tr>
                    <td><b>${m.time}</b></td>
                    <td>${m.field}<br>
                        <span class="cat-badge ${lvl.class}">${lvl.name}</span>
                        ${genderBadge}
                    </td>
                    <td>
                        <div style="display:flex; align-items:center; gap:5px;">
                            <span style="flex:1; text-align:right; ${win1}">${m.t1}</span>
                            <input type="number" value="${m.s1}" onchange="updateScore('${m.id}', 1, this.value)" onkeyup="if(event.key==='Enter')this.blur()">
                            :
                            <input type="number" value="${m.s2}" onchange="updateScore('${m.id}', 2, this.value)" onkeyup="if(event.key==='Enter')this.blur()">
                            <span style="flex:1; text-align:left; ${win2}">${m.t2}</span>
                        </div>
                    </td>
                    <td><span class="ref-badge" style="${conflictStyle}" onclick="manualRef('${m.id}')">${m.ref}</span></td>
                    <td style="text-align:center;">${(m.s1!=="" && m.s2!=="")?"‚úÖ":"‚è≥"}</td>
                </tr>`;
            });
        }
        html += `</tbody></table></div>`;
        container.innerHTML = html;
    }

    function renderStandings(container) {
        let html = "";
        const levels = ['ANU', 'P13', 'P46', 'SEC'];
        const genders = ['M', 'F'];
        const groupNames = { "A":"‡∏™‡∏≤‡∏¢ A", "B":"‡∏™‡∏≤‡∏¢ B", "C":"‡∏™‡∏≤‡∏¢ C", "M":"‡∏°‡∏±‡∏ò‡∏¢‡∏° (‡∏•‡∏µ‡∏Å)" };
        
        levels.forEach(lvl => {
            genders.forEach(gen => {
                // ‡πÄ‡∏ä‡πá‡∏Ñ‡∏Å‡πà‡∏≠‡∏ô‡∏ß‡πà‡∏≤‡∏°‡∏µ‡πÅ‡∏°‡∏ï‡∏ä‡πå‡πÉ‡∏ô category ‡∏ô‡∏µ‡πâ‡πÑ‡∏´‡∏° ‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡πá‡∏Ç‡πâ‡∏≤‡∏° (‡∏à‡∏∞‡πÑ‡∏î‡πâ‡πÑ‡∏°‡πà‡∏£‡∏Å)
                const hasMatch = matches.some(m => m.level === lvl && m.gender === gen && m.groupKey);
                if (!hasMatch) return;

                const lvlInfo = getLevelInfo(lvl);
                const genderName = gen === 'M' ? '‡∏ä‡∏≤‡∏¢' : '‡∏´‡∏ç‡∏¥‡∏á';
                
                html += `<h2 class="gender-section-title">‚öΩ ${lvlInfo.name} (${genderName})</h2>`;
                
                let stats = {};
                const allTeams = [...new Set([...groups["A"], ...groups["B"], ...groups["C"], ...groups["M"]])];
                allTeams.forEach(t => stats[t] = { P:0, W:0, D:0, L:0, GF:0, GA:0, PTS:0 });

                matches.forEach(m => {
                    // ‡∏Å‡∏£‡∏≠‡∏á Level ‡πÅ‡∏•‡∏∞ Gender
                    if (m.s1 !== "" && m.s2 !== "" && m.groupKey && m.level === lvl && m.gender === gen) {
                        let s1 = parseInt(m.s1), s2 = parseInt(m.s2);
                        updateTeamStats(stats, m.t1, s1, s2);
                        updateTeamStats(stats, m.t2, s2, s1);
                    }
                });

                Object.keys(groups).forEach(g => {
                    // ‡∏ñ‡πâ‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•‡∏≠‡∏≤‡∏à‡∏°‡∏µ‡πÅ‡∏Ñ‡πà‡∏™‡∏≤‡∏¢ A, B ‡∏Å‡πá‡πÉ‡∏´‡πâ‡πÇ‡∏ä‡∏ß‡πå‡πÅ‡∏Ñ‡πà‡∏ô‡∏±‡πâ‡∏ô (Logic ‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡πÑ‡∏î‡πâ)
                    // ‡∏≠‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡πÇ‡∏ä‡∏ß‡πå‡∏ó‡∏∏‡∏Å‡∏™‡∏≤‡∏¢‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏ó‡∏µ‡∏°‡πÅ‡∏Ç‡πà‡∏á
                    let sortedTeams = groups[g].sort((a, b) => {
                        let tA = stats[a] || {PTS:0, GF:0, GA:0}, tB = stats[b] || {PTS:0, GF:0, GA:0};
                        if (tB.PTS !== tA.PTS) return tB.PTS - tA.PTS;
                        return (tB.GF-tB.GA) - (tA.GF-tA.GA);
                    });

                    html += `<div class="standing-box">
                        <div class="standing-header"><span>${groupNames[g]}</span></div>
                        <table class="st-table"><thead><tr>
                            <th>‡∏ó‡∏µ‡∏°</th><th>P</th><th>W</th><th>D</th><th>L</th><th>GF</th><th>GA</th><th>+/-</th><th class="pts-cell">PTS</th>
                        </tr></thead><tbody>`;
                    
                    sortedTeams.forEach(t => {
                        let s = stats[t] || { P:0, W:0, D:0, L:0, GF:0, GA:0, PTS:0 };
                        html += `<tr><td>${t}</td><td>${s.P}</td><td>${s.W}</td><td>${s.D}</td><td>${s.L}</td><td>${s.GF}</td><td>${s.GA}</td><td>${s.GF-s.GA}</td><td class="pts-cell">${s.PTS}</td></tr>`;
                    });
                    html += `</tbody></table></div>`;
                });
            });
        });
        
        container.innerHTML = html;
    }

    function updateTeamStats(stats, team, gf, ga) {
        if (!stats[team]) return;
        stats[team].P++; stats[team].GF += gf; stats[team].GA += ga;
        if (gf > ga) { stats[team].W++; stats[team].PTS += 3; }
        else if (gf === ga) { stats[team].D++; stats[team].PTS += 1; }
        else { stats[team].L++; }
    }

    function updateScore(id, slot, val) {
        let m = matches.find(x => x.id === id);
        if (slot === 1) m.s1 = val; else m.s2 = val;
        
        if (m.s1 !== "" && m.s2 !== "" && m.next) {
            let winner = parseInt(m.s1) > parseInt(m.s2) ? m.t1 : m.t2;
            if (m.s1 === m.s2) winner = prompt("‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡πÄ‡∏ó‡πà‡∏≤‡∏Å‡∏±‡∏ô! ‡πÉ‡∏Ñ‡∏£‡∏ä‡∏ô‡∏∞‡∏à‡∏∏‡∏î‡πÇ‡∏ó‡∏©? (‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠‡∏ó‡∏µ‡∏°)", m.t1); 

            let nextMatch = matches.find(x => x.id === m.next);
            if (nextMatch) {
                if (m.slot === 1) nextMatch.t1 = winner; else nextMatch.t2 = winner;
            }
        }
        saveData();
        showToast();
        renderPage(); 
    }

    function manualRef(id) {
        let currentRef = matches.find(m => m.id === id).ref;
        let newRef = prompt(`‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£ (‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô: ${currentRef}):`, currentRef);
        if (newRef) { matches.find(m => m.id === id).ref = newRef; saveData(); renderPage(); }
    }

    function showToast() {
        var x = document.getElementById("toast");
        x.className = "show";
        setTimeout(function(){ x.className = x.className.replace("show", ""); }, 2000);
    }

    function saveData() { localStorage.setItem('ns_games_v15_all_levels', JSON.stringify(matches)); }
    function saveDataManual() { saveData(); alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!"); }
    function loadData() { let d = localStorage.getItem('ns_games_v15_all_levels'); if(d) matches = JSON.parse(d); }
    function resetData() { if(confirm("‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î?")) { localStorage.removeItem('ns_games_v15_all_levels'); location.reload(); } }
</script>

</body>
</html>
