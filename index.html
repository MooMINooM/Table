<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>‡∏£‡∏∞‡∏ö‡∏ö‡∏ü‡∏∏‡∏ï‡∏ö‡∏≠‡∏• ‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå ‡πÄ‡∏Å‡∏°‡∏™‡πå 2568 (V.18 Full & Variety)</title>
<link href="https://fonts.googleapis.com/css2?family=Sarabun:wght@300;400;600;700&display=swap" rel="stylesheet">
<link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
<style>
    :root { 
        --primary: #1e3a8a; --accent: #f59e0b; --success: #10b981; 
        --bg: #f3f4f6; --card-bg: #ffffff; --text: #1f2937;
    }
    body { font-family: 'Sarabun', sans-serif; background: var(--bg); margin: 0; padding: 15px; color: var(--text); padding-bottom: 80px; }
    .container { max-width: 1000px; margin: 0 auto; }
    
    .header { text-align: center; margin-bottom: 20px; background: var(--primary); color: white; padding: 20px; border-radius: 15px; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); }
    .header h1 { margin: 0; font-size: 1.5em; }
    .header p { opacity: 0.9; margin-top: 5px; font-size: 0.9em; }
    
    .nav-tabs { display: flex; gap: 8px; overflow-x: auto; padding-bottom: 10px; margin-bottom: 15px; -webkit-overflow-scrolling: touch; }
    .nav-btn { 
        background: white; border: 1px solid #e5e7eb; padding: 10px 16px; border-radius: 50px; 
        font-weight: 600; color: #4b5563; white-space: nowrap; cursor: pointer; transition: 0.2s;
        box-shadow: 0 1px 2px rgba(0,0,0,0.05);
    }
    .nav-btn.active { background: var(--primary); color: white; border-color: var(--primary); box-shadow: 0 4px 6px rgba(30, 58, 138, 0.2); }

    /* Timeline Style */
    .time-group { margin-bottom: 25px; }
    .time-header { 
        background: #dbeafe; color: #1e40af; padding: 8px 15px; border-radius: 8px; 
        font-weight: bold; margin-bottom: 10px; display: inline-block; font-size: 1.1em;
    }
    .match-card {
        background: var(--card-bg); border-radius: 12px; padding: 15px; margin-bottom: 12px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.05); border-left: 5px solid #ccc; position: relative;
    }
    .border-ANU { border-left-color: #ec4899; } /* ‡∏ä‡∏°‡∏û‡∏π */
    .border-P13 { border-left-color: #10b981; } /* ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ß */
    .border-P46 { border-left-color: #3b82f6; } /* ‡∏ü‡πâ‡∏≤ */
    .border-SEC { border-left-color: #f59e0b; } /* ‡∏™‡πâ‡∏° */

    .match-info { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; font-size: 0.85em; color: #6b7280; }
    .field-badge { background: #f3f4f6; padding: 2px 8px; border-radius: 4px; font-weight: bold; }
    .cat-badge { font-weight: bold; padding: 2px 6px; border-radius: 4px; color: white; font-size: 0.85em; }

    .match-teams { display: flex; align-items: center; justify-content: space-between; gap: 10px; margin-bottom: 10px; }
    .team { flex: 1; font-weight: 600; font-size: 1.05em; }
    .team.left { text-align: right; }
    .team.right { text-align: left; }
    .team.auto-text { color: #f59e0b; font-style: italic; font-weight: normal; font-size: 0.9em; } 
    
    .score-box { display: flex; align-items: center; gap: 5px; background: #f9fafb; padding: 5px; border-radius: 8px; border: 1px solid #e5e7eb; }
    input[type="number"] { width: 40px; padding: 5px; text-align: center; border: none; background: transparent; font-weight: bold; font-size: 1.2em; color: var(--primary); }
    input:focus { outline: none; }

    .match-footer { display: flex; justify-content: space-between; align-items: center; border-top: 1px solid #f3f4f6; padding-top: 8px; font-size: 0.85em; }
    .ref-name { color: #6b7280; font-style: italic; }
    .status-icon { font-size: 1.2em; }

    /* Standings */
    .filter-bar { display: flex; gap: 5px; margin-bottom: 15px; flex-wrap: wrap; justify-content: center; }
    .filter-btn { padding: 6px 12px; border-radius: 20px; border: 1px solid #ddd; background: white; font-size: 0.9em; cursor: pointer; }
    .filter-btn.active { background: var(--text); color: white; border-color: var(--text); }

    .standing-table { width: 100%; border-collapse: collapse; background: white; border-radius: 8px; overflow: hidden; box-shadow: 0 2px 4px rgba(0,0,0,0.05); margin-bottom: 20px; }
    .standing-table th { background: #f8fafc; padding: 10px 8px; text-align: center; font-size: 0.85em; color: #64748b; font-weight: 600; }
    .standing-table td { padding: 10px 8px; text-align: center; border-bottom: 1px solid #f1f5f9; font-size: 0.95em; }
    .standing-table td:nth-child(2) { text-align: left; font-weight: 600; color: #334155; }
    .pts-col { color: var(--primary); font-weight: 800; background: #eff6ff; }

    /* Control Panel */
    .control-panel { position: fixed; bottom: 20px; right: 20px; display: flex; gap: 10px; z-index: 1000; }
    .action-btn { width: 50px; height: 50px; border-radius: 50%; border: none; color: white; font-size: 1.2em; cursor: pointer; box-shadow: 0 4px 10px rgba(0,0,0,0.2); display: flex; align-items: center; justify-content: center; transition: transform 0.2s; }
    .action-btn:hover { transform: scale(1.1); }
    .btn-save { background: var(--success); }
    .btn-reset { background: var(--danger); }
    
    #toast { visibility: hidden; min-width: 250px; background-color: #333; color: #fff; text-align: center; border-radius: 2px; padding: 16px; position: fixed; z-index: 9999; left: 50%; bottom: 30px; transform: translateX(-50%); }
    #toast.show { visibility: visible; animation: fadein 0.5s, fadeout 0.5s 2.5s; }

    @keyframes fadein { from {bottom: 0; opacity: 0;} to {bottom: 30px; opacity: 1;} }
    @keyframes fadeout { from {bottom: 30px; opacity: 1;} to {bottom: 0; opacity: 0;} }
</style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>‚öΩ ‡∏ü‡∏∏‡∏ï‡∏ö‡∏≠‡∏• ‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå ‡πÄ‡∏Å‡∏°‡∏™‡πå 2568</h1>
        <p>‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏• ‚Ä¢ ‡∏õ.‡∏ï‡πâ‡∏ô ‚Ä¢ ‡∏õ.‡∏õ‡∏•‡∏≤‡∏¢ ‚Ä¢ ‡∏°‡∏±‡∏ò‡∏¢‡∏° (‡∏•‡∏µ‡∏Å)</p>
    </div>

    <div class="nav-tabs">
        <button class="nav-btn active" onclick="switchTab('day1')">üìÖ 16 ‡∏ò.‡∏Ñ.</button>
        <button class="nav-btn" onclick="switchTab('day2')">üìÖ 17 ‡∏ò.‡∏Ñ.</button>
        <button class="nav-btn" onclick="switchTab('day3')">üìÖ 18 ‡∏ò.‡∏Ñ.</button>
        <button class="nav-btn" onclick="switchTab('day4')">üìÖ 19 ‡∏ò.‡∏Ñ.</button>
        <button class="nav-btn" onclick="switchTab('standings')">üìä ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô</button>
    </div>

    <div id="content-area"></div>
</div>

<div id="toast">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏•‡πâ‡∏ß ‚úÖ</div>

<div class="control-panel">
    <button class="action-btn btn-save" onclick="saveDataManual()" title="‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"><i class="fas fa-save"></i></button>
    <button class="action-btn btn-reset" onclick="resetData()" title="‡∏£‡∏µ‡πÄ‡∏ã‡πá‡∏ï"><i class="fas fa-trash"></i></button>
</div>

<script>
    // --- 1. ‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏Å‡∏•‡∏∏‡πà‡∏° (‡∏™‡∏•‡∏±‡∏ö‡∏ó‡∏µ‡∏°‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏ã‡πâ‡∏≥‡∏Å‡∏±‡∏ô‡πÉ‡∏ô‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏£‡∏∏‡πà‡∏ô) ---
    const groupsConfig = {
        // ‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏• (‡∏™‡∏•‡∏±‡∏ö‡∏ó‡∏µ‡∏°)
        "ANU": {
            "A": ["‡πÇ‡∏ô‡∏ô‡∏°‡πà‡∏ß‡∏á", "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏≤‡∏ó‡∏Ø", "‡πÇ‡∏ô‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á"],
            "B": ["‡∏ó‡πà‡∏≤‡∏≠‡∏∏‡∏ó‡∏±‡∏¢", "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå‡∏Ø", "‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø"],
            "C": ["‡∏†‡∏π‡∏û‡∏£‡∏∞‡∏Ø", "‡∏î‡πâ‡∏ß‡∏á‡∏Ø-‡∏ä‡∏≥‡∏Ø", "‡πÇ‡∏ô‡∏ô‡πÑ‡∏´‡∏°‡∏Ø"]
        },
        // ‡∏õ.1-3 (‡∏™‡∏•‡∏±‡∏ö‡∏ó‡∏µ‡∏°)
        "P13": {
            "A": ["‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå‡∏Ø", "‡∏ó‡πà‡∏≤‡∏≠‡∏∏‡∏ó‡∏±‡∏¢", "‡∏†‡∏π‡∏û‡∏£‡∏∞‡∏Ø"],
            "B": ["‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏≤‡∏ó‡∏Ø", "‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø", "‡πÇ‡∏ô‡∏ô‡πÑ‡∏´‡∏°‡∏Ø"],
            "C": ["‡∏î‡πâ‡∏ß‡∏á‡∏Ø-‡∏ä‡∏≥‡∏Ø", "‡πÇ‡∏ô‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á", "‡πÇ‡∏ô‡∏ô‡∏°‡πà‡∏ß‡∏á"]
        },
        // ‡∏õ.4-6 (‡∏ï‡∏≤‡∏°‡πÄ‡∏î‡∏¥‡∏°)
        "P46": {
            "A": ["‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏≤‡∏ó‡∏Ø", "‡∏ó‡πà‡∏≤‡∏≠‡∏∏‡∏ó‡∏±‡∏¢", "‡∏î‡πâ‡∏ß‡∏á‡∏Ø-‡∏ä‡∏≥‡∏Ø"],
            "B": ["‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå‡∏Ø", "‡πÇ‡∏ô‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á", "‡πÇ‡∏ô‡∏ô‡πÑ‡∏´‡∏°‡∏Ø"],
            "C": ["‡∏†‡∏π‡∏û‡∏£‡∏∞‡∏Ø", "‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø", "‡πÇ‡∏ô‡∏ô‡∏°‡πà‡∏ß‡∏á"]
        },
        // ‡∏°‡∏±‡∏ò‡∏¢‡∏° (‡∏•‡∏µ‡∏Å ‡∏û‡∏ö‡∏Å‡∏±‡∏ô‡∏´‡∏°‡∏î)
        "SEC": {
            "M": ["‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø", "‡∏†‡∏π‡∏û‡∏£‡∏∞‡∏Ø", "‡πÇ‡∏ô‡∏ô‡∏°‡πà‡∏ß‡∏á", "‡πÇ‡∏ô‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á"]
        }
    };

    // --- 2. ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÅ‡∏°‡∏ï‡∏ä‡πå (‡∏Ñ‡∏£‡∏ö‡∏ó‡∏∏‡∏Å‡∏£‡∏∏‡πà‡∏ô) ---
    /* level: ANU, P13, P46, SEC
       autoType: ‡∏£‡∏´‡∏±‡∏™‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏ö‡∏Ñ‡∏π‡πà‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥ (QF1-4, SF1-2, FIN)
       refSource: loser_QF (‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏î‡∏∂‡∏á‡∏ó‡∏µ‡∏°‡πÅ‡∏û‡πâ‡∏°‡∏≤‡πÄ‡∏õ‡πà‡∏≤‡∏£‡∏≠‡∏ö‡∏£‡∏≠‡∏á)
    */
    let matches = [
        // ====== ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 16 ‡∏ò.‡∏Ñ. (‡∏£‡∏≠‡∏ö‡πÅ‡∏ö‡πà‡∏á‡∏Å‡∏•‡∏∏‡πà‡∏°) ======
        // --- 08.30 ---
        { id: "M1", day: "day1", time: "08.30", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P46", gender: "M", groupKey: "A", t1: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏≤‡∏ó‡∏Ø", t2: "‡∏ó‡πà‡∏≤‡∏≠‡∏∏‡∏ó‡∏±‡∏¢", s1: "", s2: "", ref: "‡∏î‡πâ‡∏ß‡∏á‡∏Ø-‡∏ä‡∏≥‡∏Ø" },
        { id: "M2", day: "day1", time: "08.30", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "SEC", gender: "M", groupKey: "M", t1: "‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø", t2: "‡∏†‡∏π‡∏û‡∏£‡∏∞‡∏Ø", s1: "", s2: "", ref: "‡πÇ‡∏ô‡∏ô‡∏°‡πà‡∏ß‡∏á" },
        { id: "A1", day: "day1", time: "08.30", field: "‡∏™‡∏ô‡∏≤‡∏°‡πÄ‡∏î‡πá‡∏Å", level: "ANU", gender: "M", groupKey: "A", t1: "‡πÇ‡∏ô‡∏ô‡∏°‡πà‡∏ß‡∏á", t2: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏≤‡∏ó‡∏Ø", s1: "", s2: "", ref: "‡πÇ‡∏ô‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á" },

        // --- 09.30 ---
        { id: "M3", day: "day1", time: "09.30", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P46", gender: "M", groupKey: "B", t1: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå‡∏Ø", t2: "‡πÇ‡∏ô‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á", s1: "", s2: "", ref: "‡πÇ‡∏ô‡∏ô‡πÑ‡∏´‡∏°‡∏Ø" },
        { id: "M4", day: "day1", time: "09.30", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "P13", gender: "M", groupKey: "A", t1: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå‡∏Ø", t2: "‡∏ó‡πà‡∏≤‡∏≠‡∏∏‡∏ó‡∏±‡∏¢", s1: "", s2: "", ref: "‡∏†‡∏π‡∏û‡∏£‡∏∞‡∏Ø" },
        { id: "A2", day: "day1", time: "09.30", field: "‡∏™‡∏ô‡∏≤‡∏°‡πÄ‡∏î‡πá‡∏Å", level: "ANU", gender: "M", groupKey: "B", t1: "‡∏ó‡πà‡∏≤‡∏≠‡∏∏‡∏ó‡∏±‡∏¢", t2: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå‡∏Ø", s1: "", s2: "", ref: "‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø" },

        // --- 10.30 ---
        { id: "M5", day: "day1", time: "10.30", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P46", gender: "M", groupKey: "C", t1: "‡∏†‡∏π‡∏û‡∏£‡∏∞‡∏Ø", t2: "‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø", s1: "", s2: "", ref: "‡πÇ‡∏ô‡∏ô‡∏°‡πà‡∏ß‡∏á" },
        { id: "M6", day: "day1", time: "10.30", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "P13", gender: "M", groupKey: "B", t1: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏≤‡∏ó‡∏Ø", t2: "‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø", s1: "", s2: "", ref: "‡πÇ‡∏ô‡∏ô‡πÑ‡∏´‡∏°‡∏Ø" },
        { id: "A3", day: "day1", time: "10.30", field: "‡∏™‡∏ô‡∏≤‡∏°‡πÄ‡∏î‡πá‡∏Å", level: "ANU", gender: "M", groupKey: "C", t1: "‡∏†‡∏π‡∏û‡∏£‡∏∞‡∏Ø", t2: "‡∏î‡πâ‡∏ß‡∏á‡∏Ø-‡∏ä‡∏≥‡∏Ø", s1: "", s2: "", ref: "‡πÇ‡∏ô‡∏ô‡πÑ‡∏´‡∏°‡∏Ø" },

        // --- 11.30 ---
        { id: "M7", day: "day1", time: "11.30", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P13", gender: "M", groupKey: "C", t1: "‡∏î‡πâ‡∏ß‡∏á‡∏Ø-‡∏ä‡∏≥‡∏Ø", t2: "‡πÇ‡∏ô‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á", s1: "", s2: "", ref: "‡πÇ‡∏ô‡∏ô‡∏°‡πà‡∏ß‡∏á" },
        { id: "M8", day: "day1", time: "11.30", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "SEC", gender: "M", groupKey: "M", t1: "‡πÇ‡∏ô‡∏ô‡∏°‡πà‡∏ß‡∏á", t2: "‡πÇ‡∏ô‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á", s1: "", s2: "", ref: "‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø" },

        // --- 13.00 ---
        { id: "M9", day: "day1", time: "13.00", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P46", gender: "M", groupKey: "A", t1: "‡∏ó‡πà‡∏≤‡∏≠‡∏∏‡∏ó‡∏±‡∏¢", t2: "‡∏î‡πâ‡∏ß‡∏á‡∏Ø-‡∏ä‡∏≥‡∏Ø", s1: "", s2: "", ref: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏≤‡∏ó‡∏Ø" },
        { id: "A4", day: "day1", time: "13.00", field: "‡∏™‡∏ô‡∏≤‡∏°‡πÄ‡∏î‡πá‡∏Å", level: "ANU", gender: "M", groupKey: "A", t1: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏≤‡∏ó‡∏Ø", t2: "‡πÇ‡∏ô‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á", s1: "", s2: "", ref: "‡πÇ‡∏ô‡∏ô‡∏°‡πà‡∏ß‡∏á" },

        // --- 14.00 ---
        { id: "M10", day: "day1", time: "14.00", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P46", gender: "M", groupKey: "B", t1: "‡πÇ‡∏ô‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á", t2: "‡πÇ‡∏ô‡∏ô‡πÑ‡∏´‡∏°‡∏Ø", s1: "", s2: "", ref: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå‡∏Ø" },
        { id: "M11", day: "day1", time: "14.00", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "P13", gender: "M", groupKey: "A", t1: "‡∏ó‡πà‡∏≤‡∏≠‡∏∏‡∏ó‡∏±‡∏¢", t2: "‡∏†‡∏π‡∏û‡∏£‡∏∞‡∏Ø", s1: "", s2: "", ref: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå‡∏Ø" },

        // ====== ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 17 ‡∏ò.‡∏Ñ. (‡∏ô‡∏±‡∏î‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡∏£‡∏≠‡∏ö‡πÅ‡∏£‡∏Å & ‡∏£‡∏≠‡∏ö 8 ‡∏ó‡∏µ‡∏°) ======
        // --- 08.30 ---
        { id: "M12", day: "day2", time: "08.30", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P46", gender: "M", groupKey: "C", t1: "‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø", t2: "‡πÇ‡∏ô‡∏ô‡∏°‡πà‡∏ß‡∏á", s1: "", s2: "", ref: "‡∏†‡∏π‡∏û‡∏£‡∏∞‡∏Ø" },
        { id: "M13", day: "day2", time: "08.30", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "SEC", gender: "M", groupKey: "M", t1: "‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø", t2: "‡πÇ‡∏ô‡∏ô‡∏°‡πà‡∏ß‡∏á", s1: "", s2: "", ref: "‡πÇ‡∏ô‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á" }, // SEC ‡∏ô‡∏±‡∏î 3
        { id: "A5", day: "day2", time: "08.30", field: "‡∏™‡∏ô‡∏≤‡∏°‡πÄ‡∏î‡πá‡∏Å", level: "ANU", gender: "M", groupKey: "B", t1: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏£‡∏£‡∏Ñ‡πå‡∏Ø", t2: "‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø", s1: "", s2: "", ref: "‡∏ó‡πà‡∏≤‡∏≠‡∏∏‡∏ó‡∏±‡∏¢" },

        // --- 09.30 ---
        { id: "M14", day: "day2", time: "09.30", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "P13", gender: "M", groupKey: "B", t1: "‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø", t2: "‡πÇ‡∏ô‡∏ô‡πÑ‡∏´‡∏°‡∏Ø", s1: "", s2: "", ref: "‡πÇ‡∏ô‡∏ô‡∏™‡∏ß‡∏≤‡∏ó‡∏Ø" },
        { id: "M15", day: "day2", time: "09.30", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "SEC", gender: "M", groupKey: "M", t1: "‡∏†‡∏π‡∏û‡∏£‡∏∞‡∏Ø", t2: "‡πÇ‡∏ô‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á", s1: "", s2: "", ref: "‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø" }, // SEC ‡∏ô‡∏±‡∏î 4

        // --- 10.30 ---
        { id: "M16", day: "day2", time: "10.30", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "P13", gender: "M", groupKey: "C", t1: "‡πÇ‡∏ô‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á", t2: "‡πÇ‡∏ô‡∏ô‡∏°‡πà‡∏ß‡∏á", s1: "", s2: "", ref: "‡∏î‡πâ‡∏ß‡∏á‡∏Ø-‡∏ä‡∏≥‡∏Ø" },
        { id: "A6", day: "day2", time: "10.30", field: "‡∏™‡∏ô‡∏≤‡∏°‡πÄ‡∏î‡πá‡∏Å", level: "ANU", gender: "M", groupKey: "C", t1: "‡∏î‡πâ‡∏ß‡∏á‡∏Ø-‡∏ä‡∏≥‡∏Ø", t2: "‡πÇ‡∏ô‡∏ô‡πÑ‡∏´‡∏°‡∏Ø", s1: "", s2: "", ref: "‡∏†‡∏π‡∏û‡∏£‡∏∞‡∏Ø" },

        // --- 11.30 (‡πÄ‡∏Å‡πá‡∏ö‡∏ï‡∏Å‡∏Ñ‡∏π‡πà‡∏™‡∏∏‡∏î‡∏ó‡πâ‡∏≤‡∏¢‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏™‡∏£‡∏∏‡∏õ‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô) ---
        { id: "M17", day: "day2", time: "11.30", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "SEC", gender: "M", groupKey: "M", t1: "‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø", t2: "‡πÇ‡∏ô‡∏ô‡πÄ‡∏°‡∏∑‡∏≠‡∏á", s1: "", s2: "", ref: "‡∏†‡∏π‡∏û‡∏£‡∏∞‡∏Ø" }, // SEC ‡∏ô‡∏±‡∏î 5
        { id: "M18", day: "day2", time: "11.30", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "SEC", gender: "M", groupKey: "M", t1: "‡∏†‡∏π‡∏û‡∏£‡∏∞‡∏Ø", t2: "‡πÇ‡∏ô‡∏ô‡∏°‡πà‡∏ß‡∏á", s1: "", s2: "", ref: "‡∏´‡∏ô‡∏≠‡∏á‡∏Å‡∏∏‡∏á‡∏®‡∏£‡∏µ‡∏Ø" }, // SEC ‡∏ô‡∏±‡∏î 6

        // --- 13.30+ ‡∏£‡∏≠‡∏ö 8 ‡∏ó‡∏µ‡∏° (Knockout) ‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö P46, P13, ANU ---
        // (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á P46)
        { id: "QF1_P46", day: "day2", time: "13.30", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P46", gender: "M", cat: "‡∏£‡∏≠‡∏ö 8 ‡∏ó‡∏µ‡∏°", autoType: "QF1_P46", t1: "(‡∏ó‡∏µ‡πà 1 A)", t2: "(‡∏ó‡∏µ‡πà 3 ‡∏î‡∏µ‡∏™‡∏∏‡∏î 1)", s1: "", s2: "", ref: "‡∏ó‡∏µ‡∏°‡∏ï‡∏Å‡∏£‡∏≠‡∏ö" },
        { id: "QF2_P46", day: "day2", time: "13.30", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "P46", gender: "M", cat: "‡∏£‡∏≠‡∏ö 8 ‡∏ó‡∏µ‡∏°", autoType: "QF2_P46", t1: "(‡∏ó‡∏µ‡πà 1 B)", t2: "(‡∏ó‡∏µ‡πà 3 ‡∏î‡∏µ‡∏™‡∏∏‡∏î 2)", s1: "", s2: "", ref: "‡∏ó‡∏µ‡∏°‡∏ï‡∏Å‡∏£‡∏≠‡∏ö" },
        { id: "QF3_P46", day: "day2", time: "14.30", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P46", gender: "M", cat: "‡∏£‡∏≠‡∏ö 8 ‡∏ó‡∏µ‡∏°", autoType: "QF3_P46", t1: "(‡∏ó‡∏µ‡πà 1 C)", t2: "(‡∏ó‡∏µ‡πà 2 A)", s1: "", s2: "", ref: "‡∏ó‡∏µ‡∏°‡∏ï‡∏Å‡∏£‡∏≠‡∏ö" },
        { id: "QF4_P46", day: "day2", time: "14.30", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "P46", gender: "M", cat: "‡∏£‡∏≠‡∏ö 8 ‡∏ó‡∏µ‡∏°", autoType: "QF4_P46", t1: "(‡∏ó‡∏µ‡πà 2 B)", t2: "(‡∏ó‡∏µ‡πà 2 C)", s1: "", s2: "", ref: "‡∏ó‡∏µ‡∏°‡∏ï‡∏Å‡∏£‡∏≠‡∏ö" },
        
        // (‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á P13 - ‡πÉ‡∏™‡πà‡∏û‡∏≠‡∏™‡∏±‡∏á‡πÄ‡∏Ç‡∏õ)
        { id: "QF1_P13", day: "day2", time: "15.30", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P13", gender: "M", cat: "‡∏£‡∏≠‡∏ö 8 ‡∏ó‡∏µ‡∏°", autoType: "QF1_P13", t1: "(‡∏ó‡∏µ‡πà 1 A)", t2: "(‡∏ó‡∏µ‡πà 3 ‡∏î‡∏µ‡∏™‡∏∏‡∏î 1)", s1: "", s2: "", ref: "‡∏ó‡∏µ‡∏°‡∏ï‡∏Å‡∏£‡∏≠‡∏ö" },
        // ... (‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏Ñ‡∏π‡πà P13, ANU ‡πÑ‡∏î‡πâ‡∏ï‡∏≤‡∏°‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£)

        // ====== ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 18 ‡∏ò.‡∏Ñ. (‡∏£‡∏≠‡∏ö‡∏£‡∏≠‡∏á‡∏ä‡∏ô‡∏∞‡πÄ‡∏•‡∏¥‡∏®) ======
        // P46
        { id: "SF1_P46", day: "day3", time: "09.00", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P46", gender: "M", cat: "‡∏£‡∏≠‡∏ö‡∏£‡∏≠‡∏á‡∏Ø", autoType: "SF1_P46", t1: "(‡∏£‡∏≠‡∏ú‡∏• QF1)", t2: "(‡∏£‡∏≠‡∏ú‡∏• QF2)", s1: "", s2: "", ref: "‡∏ó‡∏µ‡∏°‡πÅ‡∏û‡πâ QF", refSource: "loser_QF_P46" },
        { id: "SF2_P46", day: "day3", time: "10.00", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P46", gender: "M", cat: "‡∏£‡∏≠‡∏ö‡∏£‡∏≠‡∏á‡∏Ø", autoType: "SF2_P46", t1: "(‡∏£‡∏≠‡∏ú‡∏• QF3)", t2: "(‡∏£‡∏≠‡∏ú‡∏• QF4)", s1: "", s2: "", ref: "‡∏ó‡∏µ‡∏°‡πÅ‡∏û‡πâ QF", refSource: "loser_QF_P46" },
        // P13
        { id: "SF1_P13", day: "day3", time: "09.00", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "P13", gender: "M", cat: "‡∏£‡∏≠‡∏ö‡∏£‡∏≠‡∏á‡∏Ø", autoType: "SF1_P13", t1: "(‡∏£‡∏≠‡∏ú‡∏•)", t2: "(‡∏£‡∏≠‡∏ú‡∏•)", s1: "", s2: "", ref: "‡∏ó‡∏µ‡∏°‡πÅ‡∏û‡πâ QF" },
        // ANU
        { id: "SF1_ANU", day: "day3", time: "09.00", field: "‡∏™‡∏ô‡∏≤‡∏°‡πÄ‡∏î‡πá‡∏Å", level: "ANU", gender: "M", cat: "‡∏£‡∏≠‡∏ö‡∏£‡∏≠‡∏á‡∏Ø", autoType: "SF1_ANU", t1: "(‡∏£‡∏≠‡∏ú‡∏•)", t2: "(‡∏£‡∏≠‡∏ú‡∏•)", s1: "", s2: "", ref: "‡∏ó‡∏µ‡∏°‡πÅ‡∏û‡πâ QF" },

        // ====== ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà 19 ‡∏ò.‡∏Ñ. (‡∏£‡∏≠‡∏ö‡∏ä‡∏¥‡∏á‡∏ä‡∏ô‡∏∞‡πÄ‡∏•‡∏¥‡∏®) ======
        { id: "FIN_ANU", day: "day4", time: "08.30", field: "‡∏™‡∏ô‡∏≤‡∏°‡πÄ‡∏î‡πá‡∏Å", level: "ANU", gender: "M", cat: "‡∏ä‡∏¥‡∏á‡∏ä‡∏ô‡∏∞‡πÄ‡∏•‡∏¥‡∏®", autoType: "FIN_ANU", t1: "(‡∏£‡∏≠‡∏ä‡∏¥‡∏á)", t2: "(‡∏£‡∏≠‡∏ä‡∏¥‡∏á)", s1: "", s2: "", ref: "‡∏ä‡∏∏‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©" },
        { id: "FIN_P13", day: "day4", time: "08.30", field: "‡∏™‡∏ô‡∏≤‡∏° 2", level: "P13", gender: "M", cat: "‡∏ä‡∏¥‡∏á‡∏ä‡∏ô‡∏∞‡πÄ‡∏•‡∏¥‡∏®", autoType: "FIN_P13", t1: "(‡∏£‡∏≠‡∏ä‡∏¥‡∏á)", t2: "(‡∏£‡∏≠‡∏ä‡∏¥‡∏á)", s1: "", s2: "", ref: "‡∏ä‡∏∏‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©" },
        { id: "FIN_P46", day: "day4", time: "09.30", field: "‡∏™‡∏ô‡∏≤‡∏° 1", level: "P46", gender: "M", cat: "‡∏ä‡∏¥‡∏á‡∏ä‡∏ô‡∏∞‡πÄ‡∏•‡∏¥‡∏®", autoType: "FIN_P46", t1: "(‡∏£‡∏≠‡∏ä‡∏¥‡∏á)", t2: "(‡∏£‡∏≠‡∏ä‡∏¥‡∏á)", s1: "", s2: "", ref: "‡∏ä‡∏∏‡∏î‡∏û‡∏¥‡πÄ‡∏®‡∏©" },
        // ‡∏°‡∏±‡∏ò‡∏¢‡∏° (‡∏£‡∏±‡∏ö‡∏£‡∏≤‡∏á‡∏ß‡∏±‡∏•‡∏•‡∏µ‡∏Å) ‡∏´‡∏£‡∏∑‡∏≠‡∏ä‡∏¥‡∏á‡∏ñ‡πâ‡∏≤‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£
    ];

    let currentTab = 'day1';
    let currentStandingsFilter = 'ALL';

    document.addEventListener('DOMContentLoaded', () => {
        loadData();
        // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å Logic ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏£‡∏∏‡πà‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡πÅ‡∏ö‡∏ö Knockout
        processKnockoutLogic("P46");
        // processKnockoutLogic("P13"); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ‡∏ñ‡πâ‡∏≤‡πÉ‡∏™‡πà‡πÅ‡∏°‡∏ï‡∏ä‡πå‡∏Ñ‡∏£‡∏ö
        // processKnockoutLogic("ANU"); // ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÑ‡∏î‡πâ‡∏ñ‡πâ‡∏≤‡πÉ‡∏™‡πà‡πÅ‡∏°‡∏ï‡∏ä‡πå‡∏Ñ‡∏£‡∏ö
        renderPage();
    });

    function switchTab(tab) {
        currentTab = tab;
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        event.target.classList.add('active');
        renderPage();
    }

    function renderPage() {
        const container = document.getElementById('content-area');
        if (currentTab === 'standings') renderStandings(container);
        else renderSchedule(container, currentTab);
    }

    // --- Render Schedule ---
    function renderSchedule(container, day) {
        const dayMatches = matches.filter(m => m.day === day).sort((a, b) => a.time.localeCompare(b.time));
        let html = "";
        const timeSlots = [...new Set(dayMatches.map(m => m.time))];

        if (timeSlots.length === 0) html = `<div style="text-align:center; padding:40px; color:#888;">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÅ‡∏Ç‡πà‡∏á‡∏Ç‡∏±‡∏ô‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ</div>`;

        timeSlots.forEach(time => {
            html += `<div class="time-group"><div class="time-header"><i class="far fa-clock"></i> ${time} ‡∏ô.</div>`;
            const slotMatches = dayMatches.filter(m => m.time === time);
            slotMatches.forEach(m => {
                let win1 = (parseInt(m.s1) > parseInt(m.s2)) ? "color:var(--success);" : "";
                let win2 = (parseInt(m.s2) > parseInt(m.s1)) ? "color:var(--success);" : "";
                let status = (m.s1 !== "" && m.s2 !== "") ? '<i class="fas fa-check-circle" style="color:var(--success)"></i>' : '<i class="far fa-circle"></i>';
                let lvlInfo = getLevelInfo(m.level);
                let genderTxt = m.gender === 'M' ? '<span style="color:#2980b9;">‡∏ä‡∏≤‡∏¢</span>' : '<span style="color:#e84393;">‡∏´‡∏ç‡∏¥‡∏á</span>';
                let catText = m.cat ? m.cat : `‡∏™‡∏≤‡∏¢ ${m.groupKey}`;
                let t1Class = m.t1.startsWith("(") ? "auto-text" : "";
                let t2Class = m.t2.startsWith("(") ? "auto-text" : "";

                html += `
                <div class="match-card border-${m.level}">
                    <div class="match-info">
                        <span class="field-badge">${m.field}</span>
                        <span class="cat-badge" style="background:${lvlInfo.color}">${lvlInfo.name} ${genderTxt}</span>
                        <span>${catText}</span>
                    </div>
                    <div class="match-teams">
                        <div class="team left ${t1Class}" style="${win1}">${m.t1}</div>
                        <div class="score-box">
                            <input type="number" value="${m.s1}" onchange="updateScore('${m.id}', 1, this.value)" placeholder="-">
                            <span>:</span>
                            <input type="number" value="${m.s2}" onchange="updateScore('${m.id}', 2, this.value)" placeholder="-">
                        </div>
                        <div class="team right ${t2Class}" style="${win2}">${m.t2}</div>
                    </div>
                    <div class="match-footer">
                        <span class="ref-name"><i class="fas fa-whistle"></i> ‡∏Å‡∏£‡∏£‡∏°‡∏Å‡∏≤‡∏£: ${m.ref}</span>
                        <span class="status-icon">${status}</span>
                    </div>
                </div>`;
            });
            html += `</div>`;
        });
        container.innerHTML = html;
    }

    // --- Render Standings ---
    function renderStandings(container) {
        let html = `
        <div class="filter-bar">
            <button class="filter-btn ${currentStandingsFilter==='ALL'?'active':''}" onclick="setFilter('ALL')">‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</button>
            <button class="filter-btn ${currentStandingsFilter==='ANU'?'active':''}" onclick="setFilter('ANU')">‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•</button>
            <button class="filter-btn ${currentStandingsFilter==='P13'?'active':''}" onclick="setFilter('P13')">‡∏õ.1-3</button>
            <button class="filter-btn ${currentStandingsFilter==='P46'?'active':''}" onclick="setFilter('P46')">‡∏õ.4-6</button>
            <button class="filter-btn ${currentStandingsFilter==='SEC'?'active':''}" onclick="setFilter('SEC')">‡∏°‡∏±‡∏ò‡∏¢‡∏°</button>
        </div>`;

        const levels = ['ANU', 'P13', 'P46', 'SEC'];
        const genders = ['M', 'F'];
        
        levels.forEach(lvl => {
            if (currentStandingsFilter !== 'ALL' && currentStandingsFilter !== lvl) return;

            genders.forEach(gen => {
                const currentGroups = groupsConfig[lvl];
                if (!currentGroups) return;
                const hasMatch = matches.some(m => m.level === lvl && m.gender === gen && m.groupKey);
                if (!hasMatch) return;

                const lvlInfo = getLevelInfo(lvl);
                const genderName = gen === 'M' ? '‡∏ä‡∏≤‡∏¢' : '‡∏´‡∏ç‡∏¥‡∏á';
                
                html += `<h3 style="color:${lvlInfo.color}; margin-top:20px; border-bottom:2px solid #eee; padding-bottom:5px;">
                            ${lvlInfo.name} (${genderName})
                         </h3>`;
                
                let stats = calculateStats(lvl, gen);

                Object.keys(currentGroups).forEach(g => {
                    let teamList = currentGroups[g];
                    let sortedTeams = teamList.sort((a, b) => {
                        let tA = stats[a] || {PTS:0, GF:0, GA:0}, tB = stats[b] || {PTS:0, GF:0, GA:0};
                        if (tB.PTS !== tA.PTS) return tB.PTS - tA.PTS;
                        return (tB.GF-tB.GA) - (tA.GF-tA.GA);
                    });

                    html += `
                    <div style="margin-bottom:15px;">
                        <div style="font-weight:bold; font-size:0.9em; margin-bottom:5px; color:#555;">${lvl === 'SEC' ? '‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏£‡∏ß‡∏° (‡∏•‡∏µ‡∏Å)' : '‡∏™‡∏≤‡∏¢ ' + g}</div>
                        <table class="standing-table">
                            <thead><tr>
                                <th width="10%">#</th>
                                <th width="40%">‡∏ó‡∏µ‡∏°</th>
                                <th width="15%">‡πÅ‡∏Ç‡πà‡∏á</th>
                                <th width="15%">+/-</th>
                                <th width="20%">‡πÅ‡∏ï‡πâ‡∏°</th>
                            </tr></thead>
                            <tbody>`;
                    
                    sortedTeams.forEach((t, index) => {
                        let s = stats[t] || { P:0, GF:0, GA:0, PTS:0 };
                        html += `<tr>
                                    <td>${index+1}</td>
                                    <td>${t}</td>
                                    <td>${s.P}</td>
                                    <td>${s.GF-s.GA}</td>
                                    <td class="pts-col">${s.PTS}</td>
                                 </tr>`;
                    });
                    html += `</tbody></table></div>`;
                });
            });
        });
        container.innerHTML = html;
    }

    // --- Backend Logic ---
    function processKnockoutLogic(level) {
        if (!groupsConfig[level]) return;
        
        let stats = calculateStats(level, "M"); // Default ‡∏ä‡∏≤‡∏¢ (‡∏õ‡∏£‡∏±‡∏ö‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏ñ‡πâ‡∏≤‡∏°‡∏µ‡∏´‡∏ç‡∏¥‡∏á)
        let ranks = rankTeams(groupsConfig[level], stats);

        // ‡∏´‡∏≤‡∏ó‡∏µ‡πà 3 ‡∏ó‡∏µ‡πà‡∏î‡∏µ‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î
        let thirds = [];
        ["A", "B", "C"].forEach(g => {
            if(ranks[g] && ranks[g][2]) thirds.push({team: ranks[g][2], stats: stats[ranks[g][2]]});
        });
        thirds.sort((a, b) => {
             if (b.stats.PTS !== a.stats.PTS) return b.stats.PTS - a.stats.PTS;
             return (b.stats.GF - b.stats.GA) - (a.stats.GF - a.stats.GA);
        });
        let best3rd_1 = thirds[0] ? thirds[0].team : "(‡∏£‡∏≠‡∏ú‡∏•)";
        let best3rd_2 = thirds[1] ? thirds[1].team : "(‡∏£‡∏≠‡∏ú‡∏•)";

        // Update QF
        updateMatchTeam(`QF1_${level}`, ranks["A"]?.[0] || "(‡∏ó‡∏µ‡πà 1 A)", best3rd_1); 
        updateMatchTeam(`QF2_${level}`, ranks["B"]?.[0] || "(‡∏ó‡∏µ‡πà 1 B)", best3rd_2); 
        updateMatchTeam(`QF3_${level}`, ranks["C"]?.[0] || "(‡∏ó‡∏µ‡πà 1 C)", ranks["A"]?.[1] || "(‡∏ó‡∏µ‡πà 2 A)"); 
        updateMatchTeam(`QF4_${level}`, ranks["B"]?.[1] || "(‡∏ó‡∏µ‡πà 2 B)", ranks["C"]?.[1] || "(‡∏ó‡∏µ‡πà 2 C)"); 

        // Update SF
        let wQF1 = getWinner(`QF1_${level}`); let wQF2 = getWinner(`QF2_${level}`);
        let wQF3 = getWinner(`QF3_${level}`); let wQF4 = getWinner(`QF4_${level}`);
        updateMatchTeam(`SF1_${level}`, wQF1 || "(‡∏£‡∏≠‡∏ú‡∏• QF1)", wQF2 || "(‡∏£‡∏≠‡∏ú‡∏• QF2)");
        updateMatchTeam(`SF2_${level}`, wQF3 || "(‡∏£‡∏≠‡∏ú‡∏• QF3)", wQF4 || "(‡∏£‡∏≠‡∏ú‡∏• QF4)");

        // Update Referees for SF (Loser of QF)
        if(getLoser(`QF1_${level}`)) updateMatchRef(`SF1_${level}`, getLoser(`QF1_${level}`));
        if(getLoser(`QF3_${level}`)) updateMatchRef(`SF2_${level}`, getLoser(`QF3_${level}`));

        // Update Final
        let wSF1 = getWinner(`SF1_${level}`); let wSF2 = getWinner(`SF2_${level}`);
        updateMatchTeam(`FIN_${level}`, wSF1 || "(‡∏£‡∏≠‡∏ä‡∏¥‡∏á)", wSF2 || "(‡∏£‡∏≠‡∏ä‡∏¥‡∏á)");
    }

    function calculateStats(level, gender) {
        let stats = {};
        // ‡∏£‡∏ß‡∏°‡∏ó‡∏µ‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡πÉ‡∏ô‡∏£‡∏∏‡πà‡∏ô
        let allTeams = [];
        Object.values(groupsConfig[level]).forEach(list => allTeams.push(...list));
        allTeams.forEach(t => stats[t] = { P:0, PTS:0, GF:0, GA:0 });
        
        matches.forEach(m => {
            if (m.level === level && m.gender === gender && m.groupKey && m.s1 !== "" && m.s2 !== "") {
                let s1 = parseInt(m.s1), s2 = parseInt(m.s2);
                updateStat(stats, m.t1, s1, s2);
                updateStat(stats, m.t2, s2, s1);
            }
        });
        return stats;
    }

    function updateStat(stats, team, gf, ga) {
        if(!stats[team]) return;
        stats[team].P++; stats[team].GF += gf; stats[team].GA += ga;
        if(gf > ga) stats[team].PTS += 3;
        else if(gf === ga) stats[team].PTS += 1;
    }

    function rankTeams(groups, stats) {
        let ranks = {};
        for(let g in groups) {
            ranks[g] = [...groups[g]].sort((a, b) => {
                let sA = stats[a], sB = stats[b];
                if(sB.PTS !== sA.PTS) return sB.PTS - sA.PTS;
                return (sB.GF - sB.GA) - (sA.GF - sA.GA);
            });
        }
        return ranks;
    }

    function updateMatchTeam(autoType, t1, t2) {
        let m = matches.find(x => x.autoType === autoType);
        if(m) { m.t1 = t1; m.t2 = t2; }
    }
    function updateMatchRef(autoType, ref) {
        let m = matches.find(x => x.autoType === autoType);
        if(m) { m.ref = ref; }
    }
    function getWinner(autoType) {
        let m = matches.find(x => x.autoType === autoType);
        if(!m || m.s1==="" || m.s2==="") return null;
        return parseInt(m.s1) > parseInt(m.s2) ? m.t1 : m.t2;
    }
    function getLoser(autoType) {
        let m = matches.find(x => x.autoType === autoType);
        if(!m || m.s1==="" || m.s2==="") return null;
        return parseInt(m.s1) < parseInt(m.s2) ? m.t1 : m.t2;
    }

    // Helper & Actions
    function setFilter(f) { currentStandingsFilter = f; renderPage(); }
    function getLevelInfo(code) {
        switch(code) {
            case 'ANU': return { name: '‡∏≠‡∏ô‡∏∏‡∏ö‡∏≤‡∏•', color: '#ec4899' };
            case 'P13': return { name: '‡∏õ.1-3', color: '#10b981' };
            case 'P46': return { name: '‡∏õ.4-6', color: '#3b82f6' };
            case 'SEC': return { name: '‡∏°‡∏±‡∏ò‡∏¢‡∏°', color: '#f59e0b' };
            default: return { name: '', color: '#666' };
        }
    }
    function updateScore(id, slot, val) {
        let m = matches.find(x => x.id === id);
        if (slot === 1) m.s1 = val; else m.s2 = val;
        saveData();
        processKnockoutLogic("P46"); // Recalculate
        showToast();
        renderPage(); 
    }
    function showToast() { var x = document.getElementById("toast"); x.className = "show"; setTimeout(function(){ x.className = x.className.replace("show", ""); }, 2000); }
    function saveData() { localStorage.setItem('ns_games_v18_full', JSON.stringify(matches)); }
    function saveDataManual() { saveData(); alert("‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!"); }
    function loadData() { let d = localStorage.getItem('ns_games_v18_full'); if(d) matches = JSON.parse(d); }
    function resetData() { if(confirm("‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•?")) { localStorage.removeItem('ns_games_v18_full'); location.reload(); } }
</script>

</body>
</html>
